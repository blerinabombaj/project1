pipeline {
    agent any
    stages {
        stage('1. Install Maven & Build') {
            steps {
                dir('DevOps-Project-01/Java-Login-App') {
                    sh '''
                    pwd
                    ls -la
                    # Find Maven in PATH
                    which mvn || ls /usr/local/bin/mvn* /opt/homebrew/bin/mvn* || echo "Maven not found"
                    # Build with any available Maven
                    mvn clean package -DskipTests || ./mvnw clean package -DskipTests || echo "Build skipped"
                    ls -la target/
                    '''
                }
            }
        }
        stage('2. Docker Build') {
            steps {
                dir('DevOps-Project-01/Java-Login-App') {
                    sh '''
                    pwd
                    # Find Docker in PATH
                    which docker || ls /usr/local/bin/docker* /opt/homebrew/bin/docker* || echo "Docker not found"
                    # Test Docker
                    docker --version || echo "Docker not available"
                    '''
                }
            }
        }
    }
}
